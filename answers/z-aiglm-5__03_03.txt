<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" id="wrc_definitions" targetNamespace="http://bpmn.io/schema/bpmn">
  <bpmn:process id="wrc_process" name="Warranty-Replacement v1.3" isExecutable="false">
    
    <!-- Start Event -->
    <bpmn:startEvent id="wrc_start" name="Online warranty claim submitted">
      <bpmn:outgoing>wrc_flow_start_validate</bpmn:outgoing>
    </bpmn:startEvent>

    <!-- Step 2: Validation and Loop -->
    <bpmn:task id="wrc_validate_claim" name="Validate the claim">
      <bpmn:incoming>wrc_flow_start_validate</bpmn:incoming>
      <bpmn:incoming>wrc_flow_request_validate</bpmn:incoming>
      <bpmn:outgoing>wrc_flow_validate_gwcomp</bpmn:outgoing>
    </bpmn:task>

    <bpmn:exclusiveGateway id="wrc_gw_complete" name="Claim Complete?">
      <bpmn:incoming>wrc_flow_validate_gwcomp</bpmn:incoming>
      <bpmn:outgoing>wrc_flow_gwcomp_request</bpmn:outgoing>
      <bpmn:outgoing>wrc_flow_gwcomp_check</bpmn:outgoing>
    </bpmn:exclusiveGateway>

    <bpmn:task id="wrc_request_info" name="Request missing information">
      <bpmn:incoming>wrc_flow_gwcomp_request</bpmn:incoming>
      <bpmn:outgoing>wrc_flow_request_validate</bpmn:outgoing>
    </bpmn:task>

    <!-- Step 3: Eligibility Check -->
    <bpmn:task id="wrc_check_eligibility" name="Check warranty eligibility">
      <bpmn:incoming>wrc_flow_gwcomp_check</bpmn:incoming>
      <bpmn:outgoing>wrc_flow_check_gwelig</bpmn:outgoing>
    </bpmn:task>

    <bpmn:exclusiveGateway id="wrc_gw_eligibility" name="Warranty Eligible?">
      <bpmn:incoming>wrc_flow_check_gwelig</bpmn:incoming>
      <bpmn:outgoing>wrc_flow_gwelig_reject</bpmn:outgoing>
      <bpmn:outgoing>wrc_flow_gwelig_parallel</bpmn:outgoing>
    </bpmn:exclusiveGateway>

    <!-- Rejection Path -->
    <bpmn:task id="wrc_send_rejection" name="Send rejection notice">
      <bpmn:incoming>wrc_flow_gwelig_reject</bpmn:incoming>
      <bpmn:outgoing>wrc_flow_reject_end</bpmn:outgoing>
    </bpmn:task>
    
    <bpmn:endEvent id="wrc_end_rejection" name="End">
      <bpmn:incoming>wrc_flow_reject_end</bpmn:incoming>
    </bpmn:endEvent>

    <!-- Step 4: Parallel Processing -->
    <bpmn:parallelGateway id="wrc_gw_parallel_split" name="Split">
      <bpmn:incoming>wrc_flow_gwelig_parallel</bpmn:incoming>
      <bpmn:outgoing>wrc_flow_split_shipment</bpmn:outgoing>
      <bpmn:outgoing>wrc_flow_split_pickup</bpmn:outgoing>
    </bpmn:parallelGateway>

    <bpmn:task id="wrc_create_shipment" name="Create shipment order">
      <bpmn:incoming>wrc_flow_split_shipment</bpmn:incoming>
      <bpmn:outgoing>wrc_flow_shipment_join</bpmn:outgoing>
    </bpmn:task>

    <bpmn:task id="wrc_schedule_pickup" name="Schedule courier pickup">
      <bpmn:incoming>wrc_flow_split_pickup</bpmn:incoming>
      <bpmn:outgoing>wrc_flow_pickup_join</bpmn:outgoing>
    </bpmn:task>

    <bpmn:parallelGateway id="wrc_gw_parallel_join" name="Join">
      <bpmn:incoming>wrc_flow_shipment_join</bpmn:incoming>
      <bpmn:incoming>wrc_flow_pickup_join</bpmn:incoming>
      <bpmn:outgoing>wrc_flow_join_update</bpmn:outgoing>
    </bpmn:parallelGateway>

    <!-- Step 5: Finalization -->
    <bpmn:task id="wrc_update_inventory" name="Update inventory records">
      <bpmn:incoming>wrc_flow_join_update</bpmn:incoming>
      <bpmn:outgoing>wrc_flow_update_close</bpmn:outgoing>
    </bpmn:task>

    <bpmn:task id="wrc_close_claim" name="Close the claim">
      <bpmn:incoming>wrc_flow_update_close</bpmn:incoming>
      <bpmn:outgoing>wrc_flow_close_end</bpmn:outgoing>
    </bpmn:task>

    <bpmn:endEvent id="wrc_end_success" name="End">
      <bpmn:incoming>wrc_flow_close_end</bpmn:incoming>
    </bpmn:endEvent>

    <!-- Sequence Flows -->
    <bpmn:sequenceFlow id="wrc_flow_start_validate" sourceRef="wrc_start" targetRef="wrc_validate_claim" />
    <bpmn:sequenceFlow id="wrc_flow_validate_gwcomp" sourceRef="wrc_validate_claim" targetRef="wrc_gw_complete" />
    <bpmn:sequenceFlow id="wrc_flow_gwcomp_request" name="Incomplete" sourceRef="wrc_gw_complete" targetRef="wrc_request_info" />
    <bpmn:sequenceFlow id="wrc_flow_request_validate" sourceRef="wrc_request_info" targetRef="wrc_validate_claim" />
    <bpmn:sequenceFlow id="wrc_flow_gwcomp_check" name="Complete" sourceRef="wrc_gw_complete" targetRef="wrc_check_eligibility" />
    <bpmn:sequenceFlow id="wrc_flow_check_gwelig" sourceRef="wrc_check_eligibility" targetRef="wrc_gw_eligibility" />
    <bpmn:sequenceFlow id="wrc_flow_gwelig_reject" name="Out of warranty" sourceRef="wrc_gw_eligibility" targetRef="wrc_send_rejection" />
    <bpmn:sequenceFlow id="wrc_flow_reject_end" sourceRef="wrc_send_rejection" targetRef="wrc_end_rejection" />
    <bpmn:sequenceFlow id="wrc_flow_gwelig_parallel" name="Within warranty" sourceRef="wrc_gw_eligibility" targetRef="wrc_gw_parallel_split" />
    <bpmn:sequenceFlow id="wrc_flow_split_shipment" sourceRef="wrc_gw_parallel_split" targetRef="wrc_create_shipment" />
    <bpmn:sequenceFlow id="wrc_flow_split_pickup" sourceRef="wrc_gw_parallel_split" targetRef="wrc_schedule_pickup" />
    <bpmn:sequenceFlow id="wrc_flow_shipment_join" sourceRef="wrc_create_shipment" targetRef="wrc_gw_parallel_join" />
    <bpmn:sequenceFlow id="wrc_flow_pickup_join" sourceRef="wrc_schedule_pickup" targetRef="wrc_gw_parallel_join" />
    <bpmn:sequenceFlow id="wrc_flow_join_update" sourceRef="wrc_gw_parallel_join" targetRef="wrc_update_inventory" />
    <bpmn:sequenceFlow id="wrc_flow_update_close" sourceRef="wrc_update_inventory" targetRef="wrc_close_claim" />
    <bpmn:sequenceFlow id="wrc_flow_close_end" sourceRef="wrc_close_claim" targetRef="wrc_end_success" />

  </bpmn:process>

  <!-- Diagram Graphics -->
  <bpmndi:BPMNDiagram id="wrc_diagram">
    <bpmndi:BPMNPlane id="wrc_plane" bpmnElement="wrc_process">
      <!-- Start -->
      <bpmndi:BPMNShape id="wrc_shape_start" bpmnElement="wrc_start">
        <dc:Bounds x="100" y="200" width="36" height="36" />
      </bpmndi:BPMNShape>
      
      <!-- Validate Claim -->
      <bpmndi:BPMNShape id="wrc_shape_validate" bpmnElement="wrc_validate_claim">
        <dc:Bounds x="180" y="178" width="100" height="80" />
      </bpmndi:BPMNShape>
      
      <!-- Gateway Complete -->
      <bpmndi:BPMNShape id="wrc_shape_gwcomp" bpmnElement="wrc_gw_complete" isMarkerVisible="true">
        <dc:Bounds x="325" y="196" width="50" height="50" />
      </bpmndi:BPMNShape>

      <!-- Request Info (Loop) -->
      <bpmndi:BPMNShape id="wrc_shape_request" bpmnElement="wrc_request_info">
        <dc:Bounds x="300" y="310" width="100" height="80" />
      </bpmndi:BPMNShape>

      <!-- Check Eligibility -->
      <bpmndi:BPMNShape id="wrc_shape_check" bpmnElement="wrc_check_eligibility">
        <dc:Bounds x="430" y="178" width="100" height="80" />
      </bpmndi:BPMNShape>

      <!-- Gateway Eligibility -->
      <bpmndi:BPMNShape id="wrc_shape_gwelig" bpmnElement="wrc_gw_eligibility" isMarkerVisible="true">
        <dc:Bounds x="590" y="196" width="50" height="50" />
      </bpmndi:BPMNShape>

      <!-- Send Rejection -->
      <bpmndi:BPMNShape id="wrc_shape_reject_task" bpmnElement="wrc_send_rejection">
        <dc:Bounds x="680" y="60" width="100" height="80" />
      </bpmndi:BPMNShape>

      <!-- End Rejection -->
      <bpmndi:BPMNShape id="wrc_shape_end_reject" bpmnElement="wrc_end_rejection">
        <dc:Bounds x="830" y="82" width="36" height="36" />
      </bpmndi:BPMNShape>

      <!-- Parallel Split -->
      <bpmndi:BPMNShape id="wrc_shape_psplit" bpmnElement="wrc_gw_parallel_split">
        <dc:Bounds x="740" y="196" width="50" height="50" />
      </bpmndi:BPMNShape>

      <!-- Create Shipment -->
      <bpmndi:BPMNShape id="wrc_shape_shipment" bpmnElement="wrc_create_shipment">
        <dc:Bounds x="870" y="100" width="100" height="80" />
      </bpmndi:BPMNShape>

      <!-- Schedule Pickup -->
      <bpmndi:BPMNShape id="wrc_shape_pickup" bpmnElement="wrc_schedule_pickup">
        <dc:Bounds x="870" y="280" width="100" height="80" />
      </bpmndi:BPMNShape>

      <!-- Parallel Join -->
      <bpmndi:BPMNShape id="wrc_shape_pjoin" bpmnElement="wrc_gw_parallel_join">
        <dc:Bounds x="1050" y="196" width="50" height="50" />
      </bpmndi:BPMNShape>

      <!-- Update Inventory -->
      <bpmndi:BPMNShape id="wrc_shape_update" bpmnElement="wrc_update_inventory">
        <dc:Bounds x="1160" y="178" width="100" height="80" />
      </bpmndi:BPMNShape>

      <!-- Close Claim -->
      <bpmndi:BPMNShape id="wrc_shape_close" bpmnElement="wrc_close_claim">
        <dc:Bounds x="1320" y="178" width="100" height="80" />
      </bpmndi:BPMNShape>

      <!-- End Success -->
      <bpmndi:BPMNShape id="wrc_shape_end_success" bpmnElement="wrc_end_success">
        <dc:Bounds x="1480" y="200" width="36" height="36" />
      </bpmndi:BPMNShape>

      <!-- Edges (Sequence Flows) -->
      <bpmndi:BPMNEdge id="wrc_edge_start_validate" bpmnElement="wrc_flow_start_validate">
        <di:waypoint x="136" y="218" />
        <di:waypoint x="180" y="218" />
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="wrc_edge_validate_gwcomp" bpmnElement="wrc_flow_validate_gwcomp">
        <di:waypoint x="280" y="218" />
        <di:waypoint x="325" y="221" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="wrc_edge_gwcomp_request" bpmnElement="wrc_flow_gwcomp_request">
        <di:waypoint x="350" y="246" />
        <di:waypoint x="350" y="310" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="wrc_edge_request_validate" bpmnElement="wrc_flow_request_validate">
        <di:waypoint x="300" y="350" />
        <di:waypoint x="230" y="350" />
        <di:waypoint x="230" y="258" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="wrc_edge_gwcomp_check" bpmnElement="wrc_flow_gwcomp_check">
        <di:waypoint x="375" y="221" />
        <di:waypoint x="430" y="218" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="wrc_edge_check_gwelig" bpmnElement="wrc_flow_check_gwelig">
        <di:waypoint x="530" y="218" />
        <di:waypoint x="590" y="221" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="wrc_edge_gwelig_reject" bpmnElement="wrc_flow_gwelig_reject">
        <di:waypoint x="615" y="196" />
        <di:waypoint x="615" y="100" />
        <di:waypoint x="680" y="100" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="wrc_edge_reject_end" bpmnElement="wrc_flow_reject_end">
        <di:waypoint x="780" y="100" />
        <di:waypoint x="830" y="100" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="wrc_edge_gwelig_parallel" bpmnElement="wrc_flow_gwelig_parallel">
        <di:waypoint x="640" y="221" />
        <di:waypoint x="740" y="221" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="wrc_edge_split_shipment" bpmnElement="wrc_flow_split_shipment">
        <di:waypoint x="765" y="196" />
        <di:waypoint x="765" y="140" />
        <di:waypoint x="870" y="140" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="wrc_edge_split_pickup" bpmnElement="wrc_flow_split_pickup">
        <di:waypoint x="765" y="246" />
        <di:waypoint x="765" y="320" />
        <di:waypoint x="870" y="320" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="wrc_edge_shipment_join" bpmnElement="wrc_flow_shipment_join">
        <di:waypoint x="970" y="140" />
        <di:waypoint x="1075" y="140" />
        <di:waypoint x="1075" y="196" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="wrc_edge_pickup_join" bpmnElement="wrc_flow_pickup_join">
        <di:waypoint x="970" y="320" />
        <di:waypoint x="1075" y="320" />
        <di:waypoint x="1075" y="246" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="wrc_edge_join_update" bpmnElement="wrc_flow_join_update">
        <di:waypoint x="1100" y="221" />
        <di:waypoint x="1160" y="218" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="wrc_edge_update_close" bpmnElement="wrc_flow_update_close">
        <di:waypoint x="1260" y="218" />
        <di:waypoint x="1320" y="218" />
      </bpmndi:BPMNEdge>

      <bpmndi:BPMNEdge id="wrc_edge_close_end" bpmnElement="wrc_flow_close_end">
        <di:waypoint x="1420" y="218" />
        <di:waypoint x="1480" y="218" />
      </bpmndi:BPMNEdge>

    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>